vizlab: "0.2.2.9003"
info:
  id: vizstorm
  name: Template for storm event visualizations
  date: 2017-10-26
  publish-date: 2017-11-09
  path: /vizstorm
  analytics-id: UA-78530187-1
  description: >-
    Template for storm event visualizations
  thumbnail:
    url:
    width: 250
    height: 250
    alttext:
  required-packages:
    vizlab:
      repo: github
      version: 0.2.2.9003
      name: USGS-VIZLAB/vizlab
      ref: v0.2.2.9003
    dplyr:
      repo: CRAN
      version: 0.5.0
    maps:
      repo: CRAN
      version: 3.2.0
    mapdata: 
      repo: CRAN
      version: 2.2-6
    sf:
      repo: CRAN
      version: 0.4.3
    svglite:
      repo: CRAN 
      version: 1.2.0
    lazyeval:
      repo: CRAN
      version: 0.2.0
parameter:
  -
    id: spatial_metadata
    crs: '+init=epsg:2163'
    bbox: [-87, 21, -70, 34]
  -
    id: plot_metadata
    height: 5
    width: 8
    pointsize: 12

fetch:
  -
    id: viewbox_limits
    location: cache/viewbox_limits.rds
    reader: rds
    fetcher: viewbox_limits
    scripts: [scripts/fetch/viewbox_limits.R , scripts/fetch/utils.R]
    depends: ["spatial_metadata", "plot_metadata"]
    comment: sets up the basic view window and projection
  -
    id: state_map_data
    location: cache/state_map_data.rds
    reader: rds
    fetcher: map_data
    fetch_args:
      database: state
    scripts: [scripts/fetch/map_data.R , scripts/fetch/utils.R]
    depends: viewbox_limits
  -
    id: county_map_data
    location: cache/county_map_data.rds
    reader: rds
    fetcher: map_data
    fetch_args:
      database: county
    scripts: [scripts/fetch/map_data.R , scripts/fetch/utils.R]
    depends: viewbox_limits
  -
    id: puerto_rico_map_data
    location: cache/puerto_rico_map_data.rds
    reader: rds
    fetcher: map_data
    fetch_args:
      database: world
      region: "Puerto Rico"
    scripts: [scripts/fetch/map_data.R , scripts/fetch/utils.R]
    depends: viewbox_limits
  -
    id: islands_map_data
    location: cache/islands_map_data.rds
    reader: rds
    fetcher: map_data
    fetch_args:
      database: mapdata::world2Hires
      regions: "(?!USA)"
      xlim: [275, 300]
      ylim: [16, 30]
    scripts: [scripts/fetch/map_data.R , scripts/fetch/utils.R]
    depends: viewbox_limits
process:
  - 
    id: state_geoms_dataframe
    location: cache/state_geoms_dataframe.rds
    reader: rds
    processor: geom_dataframe
    eval_args:
      class: I("state")
      mouseover: "sprintf('hovertext(\"%s\", evt)', ID)"
      mouseout: I("hovertext(\" \")")
    depends: 
      clip_box: "viewbox_limits"
      spatial_data: "state_map_data"
    scripts: [scripts/process/geom_dataframe.R]
  -
    id: precip_grid
    location: cache/precip_grid.rds
    reader: rds
    cell_size: 80000
    processor: grid_from_mask
    scripts: [scripts/process/grid_from_mask.R]
    depends: 
      clip_poly: "state_map_data"
visualize:
publish:
